"use client";

import { useParams } from "next/navigation";
import Link from "next/link";
import Image from "next/image";
import { ArrowLeft, Clock, Eye, Calendar, Share2 } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import { MainLayout } from "@/components/layout/MainLayout";

const categoryNames: Record<string, string> = {
  "business-tips": "Бізнес-поради",
  "finance": "Фінанси",
  "legal": "Юридичні питання",
  "security": "Безпека",
  "maintenance": "Технічне обслуговування",
  "certification": "Сертифікація",
  "technology": "Технології",
  "partnerships": "Партнерства",
  "trends": "Тренди",
};

const articlesContent: Record<string, {
  title: string;
  image: string;
  readTime: number;
  views: number;
  date: string;
  content: string[];
}> = {
  "restaurant-management-basics": {
    title: "Основи управління рестораном",
    image: "https://images.unsplash.com/photo-1556761175-b413da4baf72?w=1200",
    readTime: 10,
    views: 2500,
    date: "10 січня 2024",
    content: [
      "Управління рестораном — це складний процес, який вимагає знань у багатьох сферах: від кулінарії до фінансів, від маркетингу до управління персоналом.",
      "**Ключові аспекти управління:**\n• Фінансовий менеджмент\n• Управління персоналом\n• Контроль якості\n• Маркетинг та продажі\n• Операційна ефективність",
      "**Фінансовий менеджмент:**\nКонтролюйте фудкост (25-35% від виручки), лейборкост (25-30%) та інші операційні витрати. Ведіть щоденний облік продажів та витрат.",
      "**Управління персоналом:**\nСтворіть чіткі посадові інструкції, систему мотивації та регулярно проводьте навчання. Хороша команда — запорука успіху.",
      "**Контроль якості:**\nВпровадьте стандарти приготування страв, обслуговування гостей та чистоти закладу. Регулярно перевіряйте їх дотримання.",
    ],
  },
  "customer-service-tips": {
    title: "Як покращити сервіс у закладі",
    image: "https://images.unsplash.com/photo-1559339352-11d035aa65de?w=1200",
    readTime: 8,
    views: 1800,
    date: "8 січня 2024",
    content: [
      "Якісний сервіс — це те, що відрізняє успішний заклад від посереднього. Гості запам'ятовують не тільки їжу, але й враження від обслуговування.",
      "**5 правил відмінного сервісу:**\n1. Привітання протягом 30 секунд\n2. Знання меню напам'ять\n3. Увага до деталей\n4. Швидке вирішення проблем\n5. Щира посмішка",
      "**Навчання персоналу:**\nПроводьте регулярні тренінги з сервісу. Розбирайте реальні ситуації та вчіть персонал працювати зі скаргами.",
      "**Зворотний зв'язок:**\nЗбирайте відгуки від гостей та аналізуйте їх. Це допоможе знайти слабкі місця в сервісі.",
    ],
  },
  "crisis-management": {
    title: "Антикризовий менеджмент для ресторанів",
    image: "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=1200",
    readTime: 12,
    views: 3200,
    date: "5 січня 2024",
    content: [
      "Кризи трапляються в кожному бізнесі. Головне — бути готовим і знати, як діяти.",
      "**Типи криз:**\n• Фінансова криза\n• Репутаційна криза\n• Операційна криза\n• Зовнішня криза (пандемія, війна)",
      "**Як підготуватись:**\n1. Створіть фінансову подушку (3-6 місяців витрат)\n2. Диверсифікуйте канали продажів\n3. Побудуйте лояльну базу клієнтів\n4. Майте план Б для постачань",
      "**Під час кризи:**\n• Скоротіть витрати, але не якість\n• Комунікуйте з командою та гостями\n• Шукайте нові можливості\n• Не панікуйте",
    ],
  },
  "restaurant-budgeting": {
    title: "Бюджетування ресторану: повний гайд",
    image: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=1200",
    readTime: 15,
    views: 2800,
    date: "3 січня 2024",
    content: [
      "Правильне бюджетування — основа фінансового здоров'я ресторану.",
      "**Структура витрат:**\n• Фудкост: 28-35%\n• Персонал: 25-30%\n• Оренда: 8-12%\n• Комунальні: 3-5%\n• Маркетинг: 2-5%\n• Інше: 5-10%",
      "**Як скласти бюджет:**\n1. Проаналізуйте історичні дані\n2. Встановіть реалістичні цілі\n3. Плануйте сезонність\n4. Залиште резерв на непередбачені витрати",
      "**Контроль виконання:**\nПорівнюйте план з фактом щотижня. Швидко реагуйте на відхилення.",
    ],
  },
  "cost-control": {
    title: "Контроль витрат у ресторанному бізнесі",
    image: "https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=1200",
    readTime: 11,
    views: 2100,
    date: "1 січня 2024",
    content: [
      "Контроль витрат — це не про економію на всьому, а про розумне використання ресурсів.",
      "**Де можна економити:**\n• Оптимізація закупівель\n• Зменшення відходів\n• Енергоефективність\n• Автоматизація процесів",
      "**Де не можна економити:**\n• Якість продуктів\n• Зарплата ключових співробітників\n• Безпека\n• Чистота",
      "**Інструменти контролю:**\n• Інвентаризація\n• ABC-аналіз меню\n• Нормування порцій\n• Облікові системи",
    ],
  },
  "profit-margins": {
    title: "Як збільшити прибутковість закладу",
    image: "https://images.unsplash.com/photo-1579532537598-459ecdaf39cc?w=1200",
    readTime: 9,
    views: 3500,
    date: "28 грудня 2023",
    content: [
      "Прибутковість ресторану залежить від багатьох факторів. Розглянемо основні стратегії її підвищення.",
      "**Збільшення виручки:**\n• Підвищення середнього чека\n• Збільшення потоку гостей\n• Розширення каналів продажів\n• Upselling та cross-selling",
      "**Оптимізація витрат:**\n• Перегляд меню (прибуткові vs збиткові позиції)\n• Переговори з постачальниками\n• Оптимізація штату\n• Енергозбереження",
      "**Формула успіху:**\nПрибуток = (Виручка × Маржа) – Постійні витрати. Працюйте над кожним елементом.",
    ],
  },
  "restaurant-licenses": {
    title: "Які ліцензії потрібні для ресторану",
    image: "https://images.unsplash.com/photo-1589829545856-d10d557cf95f?w=1200",
    readTime: 14,
    views: 4200,
    date: "25 грудня 2023",
    content: [
      "Відкриття ресторану вимагає отримання низки дозвільних документів. Ось повний перелік.",
      "**Обов'язкові документи:**\n• Реєстрація ФОП або ТОВ\n• Ліцензія на роздрібну торгівлю алкоголем\n• Дозвіл СЕС\n• Пожежний сертифікат\n• Договір на вивіз сміття",
      "**Ліцензія на алкоголь:**\nВартість залежить від типу (пиво, вино, міцні напої) та регіону. Подавайте документи заздалегідь — процес займає 1-2 місяці.",
      "**Перевірки:**\nПідготуйтесь до перевірок СЕС, пожежної та податкової служби. Тримайте всі документи в порядку.",
    ],
  },
  "labor-law": {
    title: "Трудове законодавство для рестораторів",
    image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=1200",
    readTime: 12,
    views: 1900,
    date: "22 грудня 2023",
    content: [
      "Правильне оформлення персоналу захистить вас від штрафів та судових позовів.",
      "**Оформлення працівників:**\n• Трудовий договір\n• Наказ про прийняття\n• Запис у трудову книжку\n• Повідомлення ДПС",
      "**Робочий час:**\n• Норма: 40 годин на тиждень\n• Понаднормові: оплата х1.5-2\n• Нічна робота: доплата 20%\n• Вихідні: оплата х2",
      "**Відпустки та лікарняні:**\nМінімальна відпустка — 24 календарних дні. Лікарняні оплачуються за рахунок роботодавця перші 5 днів.",
    ],
  },
  "inspections-guide": {
    title: "Як підготуватись до перевірок",
    image: "https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=1200",
    readTime: 10,
    views: 2700,
    date: "20 грудня 2023",
    content: [
      "Перевірки — невід'ємна частина ресторанного бізнесу. Підготовка — ключ до успіху.",
      "**Типи перевірок:**\n• Планові (повідомляють за 10 днів)\n• Позапланові (за скаргами)\n• Рейдові (без попередження)",
      "**Що перевіряють:**\n• Документи та ліцензії\n• Санітарні норми\n• Пожежна безпека\n• Трудове законодавство\n• Касова дисципліна",
      "**Чек-лист підготовки:**\n1. Актуальні всі ліцензії\n2. Санітарні книжки персоналу\n3. Температурні журнали\n4. Сертифікати на продукти\n5. Договори з постачальниками",
    ],
  },
  "fire-safety": {
    title: "Пожежна безпека в ресторані",
    image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=1200",
    readTime: 11,
    views: 1800,
    date: "18 грудня 2023",
    content: [
      "Пожежна безпека — це не тільки вимога закону, але й захист життя ваших гостей та персоналу.",
      "**Обов'язкове обладнання:**\n• Вогнегасники (1 на 50 м²)\n• Пожежна сигналізація\n• Плани евакуації\n• Аварійне освітлення\n• Вентиляція з протипожежними клапанами",
      "**Вимоги до кухні:**\n• Система гасіння над плитою\n• Негорючі матеріали\n• Регулярне чищення витяжки\n• Окремий електрощит",
      "**Навчання персоналу:**\nПроводьте навчання з пожежної безпеки кожні 6 місяців. Тренуйте евакуацію.",
    ],
  },
  "video-surveillance": {
    title: "Відеоспостереження для закладів",
    image: "https://images.unsplash.com/photo-1557597774-9d273605dfa9?w=1200",
    readTime: 8,
    views: 1500,
    date: "15 грудня 2023",
    content: [
      "Відеоспостереження захищає від крадіжок, допомагає контролювати персонал та вирішувати спори з гостями.",
      "**Де встановлювати камери:**\n• Каса та бар\n• Вхід/вихід\n• Кухня\n• Склад\n• Зал (з урахуванням приватності)",
      "**Технічні вимоги:**\n• Роздільна здатність: мінімум 2 МП\n• Зберігання: 30+ днів\n• Нічний режим\n• Віддалений доступ",
      "**Правові аспекти:**\nПовідомте відвідувачів про відеозйомку (табличка). Не записуйте звук без згоди.",
    ],
  },
  "food-safety": {
    title: "Безпека харчових продуктів",
    image: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=1200",
    readTime: 13,
    views: 2400,
    date: "12 грудня 2023",
    content: [
      "Безпека харчових продуктів — це основа репутації вашого закладу та здоров'я гостей.",
      "**Температурний контроль:**\n• Холодильник: +2...+6°C\n• Морозилка: -18°C і нижче\n• Гаряча лінія: +65°C і вище\n• Зона небезпеки: +5...+60°C",
      "**FIFO принцип:**\nFirst In — First Out. Використовуйте спочатку продукти, які надійшли раніше.",
      "**Гігієна персоналу:**\n• Миття рук кожні 30 хвилин\n• Чистий спецодяг\n• Санітарні книжки\n• Заборона працювати хворим",
    ],
  },
  "equipment-maintenance": {
    title: "Обслуговування кухонного обладнання",
    image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=1200",
    readTime: 9,
    views: 1600,
    date: "6 грудня 2023",
    content: [
      "Правильне обслуговування обладнання продовжує термін його служби та запобігає дорогим ремонтам.",
      "**Щоденне обслуговування:**\n• Чистка робочих поверхонь\n• Перевірка температури холодильників\n• Очищення фільтрів витяжки\n• Злив конденсату",
      "**Щотижневе обслуговування:**\n• Глибоке чищення печей\n• Розморожування морозильників\n• Перевірка ущільнювачів дверей\n• Чистка кавомашини",
      "**Щомісячне обслуговування:**\n• Професійна чистка витяжки\n• Калібрування термостатів\n• Перевірка газових з'єднань\n• Огляд електропроводки",
    ],
  },
  "hvac-systems": {
    title: "Вентиляція та кондиціювання",
    image: "https://images.unsplash.com/photo-1621905252507-b35492cc74b4?w=1200",
    readTime: 7,
    views: 1200,
    date: "4 грудня 2023",
    content: [
      "Правильна вентиляція забезпечує комфорт гостей та безпеку персоналу на кухні.",
      "**Вимоги до вентиляції кухні:**\n• Кратність повітрообміну: 20-30 на годину\n• Швидкість потоку над плитою: 0.3-0.5 м/с\n• Окремі витяжки для гарячого та холодного цехів",
      "**Кондиціювання залу:**\n• Оптимальна температура: 22-24°C\n• Вологість: 40-60%\n• Уникайте протягів на гостей",
      "**Регулярне обслуговування:**\n• Заміна фільтрів кожні 1-3 місяці\n• Чистка теплообмінників\n• Перевірка рівня фреону\n• Дезінфекція повітроводів",
    ],
  },
  "haccp-implementation": {
    title: "Впровадження HACCP у ресторані",
    image: "https://images.unsplash.com/photo-1576091160550-2173dba999ef?w=1200",
    readTime: 16,
    views: 3100,
    date: "2 грудня 2023",
    content: [
      "HACCP (Hazard Analysis and Critical Control Points) — це система управління безпекою харчових продуктів.",
      "**7 принципів HACCP:**\n1. Аналіз небезпек\n2. Визначення критичних контрольних точок\n3. Встановлення критичних меж\n4. Моніторинг ККТ\n5. Коригувальні дії\n6. Верифікація\n7. Документування",
      "**Критичні контрольні точки в ресторані:**\n• Приймання продуктів (температура)\n• Зберігання (температура, терміни)\n• Термічна обробка (внутрішня температура)\n• Охолодження готових страв\n• Роздача (час на лінії)",
      "**Документація:**\nВедіть журнали температурного контролю, чек-листи прибирання, записи про навчання персоналу.",
    ],
  },
  "organic-certification": {
    title: "Органічна сертифікація для закладів",
    image: "https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=1200",
    readTime: 11,
    views: 1700,
    date: "30 листопада 2023",
    content: [
      "Органічна сертифікація підтверджує використання продуктів без хімічних добрив та пестицидів.",
      "**Переваги сертифікації:**\n• Вищі ціни (премія 20-50%)\n• Лояльність еко-свідомих гостей\n• Маркетингова перевага\n• Краща якість інгредієнтів",
      "**Вимоги для отримання:**\n• 95%+ органічних інгредієнтів\n• Сертифіковані постачальники\n• Окреме зберігання органіки\n• Документування походження",
      "**Процес сертифікації:**\n1. Подання заявки\n2. Аудит закладу\n3. Перевірка документації\n4. Видача сертифікату\n5. Щорічний контроль",
    ],
  },
  "restaurant-automation": {
    title: "Автоматизація ресторанного бізнесу",
    image: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=1200",
    readTime: 12,
    views: 2900,
    date: "22 листопада 2023",
    content: [
      "Автоматизація дозволяє оптимізувати процеси та зменшити людський фактор.",
      "**Що можна автоматизувати:**\n• Прийом замовлень (QR-меню, кіоски)\n• Облік (POS-системи)\n• Склад та закупівлі\n• Бронювання столиків\n• Маркетинг (email, SMS)",
      "**Популярні рішення в Україні:**\n• POS-системи: Poster, iiko, R-Keeper, Goovii\n• Бронювання: Tablein, ReservApp\n• Доставка: Glovo, Bolt Food\n• CRM: amoCRM, Bitrix24",
      "**ROI автоматизації:**\n• Економія часу персоналу (до 30%)\n• Зменшення помилок\n• Покращення аналітики\n• Підвищення лояльності гостей",
    ],
  },
  "ai-in-restaurants": {
    title: "Штучний інтелект у ресторанах",
    image: "https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=1200",
    readTime: 10,
    views: 2200,
    date: "20 листопада 2023",
    content: [
      "AI трансформує ресторанний бізнес від прогнозування попиту до персоналізації досвіду гостей.",
      "**Застосування AI:**\n• Прогнозування продажів\n• Оптимізація меню\n• Чат-боти для бронювання\n• Персоналізовані рекомендації\n• Аналіз відгуків",
      "**Приклади:**\n• McDonald's — динамічне ціноутворення\n• Starbucks — персоналізовані пропозиції\n• Domino's — прогнозування часу доставки",
      "**Як почати:**\n1. Визначте бізнес-проблему\n2. Зберіть якісні дані\n3. Виберіть відповідне рішення\n4. Протестуйте на малому масштабі\n5. Масштабуйте успішні експерименти",
    ],
  },
  "restaurant-collaborations": {
    title: "Колаборації між закладами",
    image: "https://images.unsplash.com/photo-1521737711867-e3b97375f902?w=1200",
    readTime: 8,
    views: 1500,
    date: "12 листопада 2023",
    content: [
      "Колаборації допомагають залучити нову аудиторію та створити унікальний досвід.",
      "**Типи колаборацій:**\n• Спільні меню (4 руки)\n• Pop-up заходи\n• Кросс-промоції\n• Спільні закупівлі",
      "**Як знайти партнера:**\n• Заклади з комплементарною концепцією\n• Неконкуруючі локації\n• Схожа цільова аудиторія\n• Спільні цінності",
      "**Приклади успішних колаборацій:**\n• Ресторан + Крафтова пивоварня\n• Кав'ярня + Кондитерська\n• Fine dining + Street food",
    ],
  },
  "supplier-partnerships": {
    title: "Партнерство з постачальниками",
    image: "https://images.unsplash.com/photo-1556745757-8d76bdb6984b?w=1200",
    readTime: 7,
    views: 1300,
    date: "10 листопада 2023",
    content: [
      "Надійні постачальники — запорука стабільної якості та оптимальних цін.",
      "**Як обирати постачальника:**\n• Якість продукції\n• Стабільність поставок\n• Гнучкість умов\n• Прозоре ціноутворення\n• Швидкість реагування",
      "**Побудова відносин:**\n• Вчасна оплата\n• Чітка комунікація\n• Зворотний зв'язок про якість\n• Довгострокові контракти",
      "**Переговори:**\n• Просіть знижки за обсяг\n• Домовляйтесь про відтермінування\n• Фіксуйте ціни на сезон\n• Отримуйте бонусні позиції",
    ],
  },
  "restaurant-trends-2024": {
    title: "Ресторанні тренди 2024 року",
    image: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=1200",
    readTime: 10,
    views: 4500,
    date: "8 листопада 2023",
    content: [
      "2024 рік принесе нові тренди в ресторанний бізнес. Розглянемо головні з них.",
      "**Головні тренди:**\n• Гіперлокальність (продукти з 50 км)\n• Ферментація та древні техніки\n• Безалкогольні напої\n• Ghost kitchens\n• Персоналізація через AI",
      "**Технологічні тренди:**\n• QR-меню як стандарт\n• Голосове замовлення\n• Роботизація кухні\n• Блокчейн для traceability",
      "**Соціальні тренди:**\n• Екологічна відповідальність\n• Інклюзивність меню\n• Wellbeing-кухня\n• Прозорість інгредієнтів",
    ],
  },
  "future-of-dining": {
    title: "Майбутнє ресторанного бізнесу",
    image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1200",
    readTime: 12,
    views: 3200,
    date: "5 листопада 2023",
    content: [
      "Як буде виглядати ресторанний бізнес через 10 років? Прогнози експертів.",
      "**Зміни в споживанні:**\n• Більше delivery та takeaway\n• Гібридні формати (ресторан + ритейл)\n• Subscription моделі\n• Віртуальні бренди",
      "**Технології майбутнього:**\n• Повністю автоматизовані кухні\n• 3D-друк їжі\n• Вирощування м'яса в лабораторії\n• VR-досвід у ресторанах",
      "**Що залишиться незмінним:**\n• Цінність людського контакту\n• Атмосфера та емоції\n• Соціалізація за їжею\n• Креативність шефів",
    ],
  },
};

export default function EstablishmentArticlePage() {
  const params = useParams();
  const categorySlug = params.slug as string;
  const articleSlug = params.article as string;
  
  const categoryName = categoryNames[categorySlug];
  const article = articlesContent[articleSlug];

  if (!article || !categoryName) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <h1 className="text-2xl font-bold text-zinc-100 mb-4">Статтю не знайдено</h1>
          <Link href="/establishments" className="text-amber-500 hover:text-amber-400">
            Повернутись до закладів
          </Link>
        </div>
      </div>
    );
  }

  return (
    <MainLayout>
    <div className="min-h-screen py-8">
      <div className="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
        <Link
          href={categorySlug === "partnerships" ? "/" : `/establishments/category/${categorySlug}`}
          className="inline-flex items-center gap-2 text-zinc-400 hover:text-zinc-100 transition-colors mb-6"
        >
          <ArrowLeft className="h-4 w-4" />
          {categorySlug === "partnerships" ? "На головну" : `Назад до ${categoryName}`}
        </Link>

        <article>
          <div className="relative h-64 md:h-96 rounded-2xl overflow-hidden mb-8">
            <Image
              src={article.image}
              alt={article.title}
              fill
              className="object-cover"
            />
            <div className="absolute inset-0 bg-gradient-to-t from-zinc-900 via-zinc-900/50 to-transparent" />
            <div className="absolute bottom-0 left-0 right-0 p-6 md:p-8">
              <div className="flex flex-wrap gap-4 text-sm text-zinc-300 mb-4">
                <span className="flex items-center gap-1">
                  <Calendar className="h-4 w-4" />
                  {article.date}
                </span>
                <span className="flex items-center gap-1">
                  <Clock className="h-4 w-4" />
                  {article.readTime} хв читання
                </span>
                <span className="flex items-center gap-1">
                  <Eye className="h-4 w-4" />
                  {article.views} переглядів
                </span>
              </div>
              <h1 className="text-2xl md:text-4xl font-bold text-zinc-100">
                {article.title}
              </h1>
            </div>
          </div>

          <Card>
            <CardContent className="p-6 md:p-8">
              <div className="prose prose-invert prose-amber max-w-none">
                {article.content.map((paragraph, index) => (
                  <div key={index} className="mb-6">
                    {paragraph.split('\n').map((line, lineIndex) => {
                      if (line.startsWith('**') && line.endsWith('**')) {
                        return (
                          <h3 key={lineIndex} className="text-xl font-bold text-amber-400 mb-3 mt-6">
                            {line.replace(/\*\*/g, '')}
                          </h3>
                        );
                      } else if (line.startsWith('**')) {
                        const parts = line.split('**');
                        return (
                          <div key={lineIndex}>
                            <h3 className="text-xl font-bold text-amber-400 mb-3 mt-6">
                              {parts[1]}
                            </h3>
                            <p className="text-zinc-300 leading-relaxed whitespace-pre-line">
                              {parts[2]}
                            </p>
                          </div>
                        );
                      } else if (line.startsWith('•')) {
                        return (
                          <p key={lineIndex} className="text-zinc-300 leading-relaxed pl-4">
                            {line}
                          </p>
                        );
                      } else {
                        return (
                          <p key={lineIndex} className="text-zinc-300 leading-relaxed">
                            {line}
                          </p>
                        );
                      }
                    })}
                  </div>
                ))}
              </div>
            </CardContent>
          </Card>

          <div className="flex justify-center mt-8">
            <Button variant="outline" size="lg" className="gap-2">
              <Share2 className="h-4 w-4" />
              Поділитись статтею
            </Button>
          </div>
        </article>
      </div>
    </div>
    </MainLayout>
  );
}

